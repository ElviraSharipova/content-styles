{"ast":null,"code":"import _toConsumableArray from\"/home/dekor/eqvium/react_material_test/admin-full/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/dekor/eqvium/react_material_test/admin-full/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from\"react\";import{Grid}from\"@material-ui/core\";import{useTheme}from\"@material-ui/styles\";import{Typography,Button}from'../../components/Wrappers';import ReactApexChart from\"react-apexcharts\";import ApexCharts from\"apexcharts\";import ApexLineChart from\"./components/ApexLineChart\";import ApexHeatmap from\"./components/ApexHeatmap\";// components\nimport Widget from\"../../components/Widget/Widget\";export default function Charts(props){var zero_array=new Array(300).fill([0,0]);//var 1_array = new Array(300).fill([300,0]);\n//var prev = 0;\nvar ws=useRef(null);var _useState=useState(zero_array),_useState2=_slicedToArray(_useState,2),data1=_useState2[0],updateData1=_useState2[1];var _useState3=useState(zero_array),_useState4=_slicedToArray(_useState3,2),data2=_useState4[0],updateData2=_useState4[1];var _useState5=useState([0,0,0,0,0,0,0,0]),_useState6=_slicedToArray(_useState5,2),data3=_useState6[0],updateData3=_useState6[1];useEffect(function(){ws.current=new WebSocket(\"ws://79.143.25.41:8080/gear\");ws.current.binaryType='arraybuffer';ws.current.onopen=function(){console.log(\"ws opened\");};ws.current.onclose=function(){return console.log(\"ws closed\");};return function(){ws.current.close();};},[]);useEffect(function(){if(!ws.current)return;ws.current.onmessage=function(e){console.log(JSON.parse(e.data));var message=JSON.parse(e.data);if(!message.hasOwnProperty('system')){var array1;var array2;var array3;if(message[\"data\"][\"data\"]!=null){if(message[\"data\"][\"sensor\"]==\"head\"){var len=message[\"data\"][\"data\"].length;//var slice1 = message[\"data\"][\"data\"].map(function(v){ return [v[0], v[1]] });\n//var slice2 = message[\"data\"][\"data\"].map(function(v){ return [v[0], v[2]] });\n//array1 = [...data1, [ message[\"data\"][\"data\"][0][0], message[\"data\"][\"data\"][0][1]]]; \n//array2 = [...data2, [ message[\"data\"][\"data\"][0][0], message[\"data\"][\"data\"][0][2]]]; \nfor(var i=0;i<len;i++){array1=[].concat(_toConsumableArray(data1),[[message[\"data\"][\"data\"][i][0],message[\"data\"][\"data\"][i][1]]]);array2=[].concat(_toConsumableArray(data2),[[message[\"data\"][\"data\"][i][0],message[\"data\"][\"data\"][i][2]]]);array1.shift();array2.shift();}//array1 = [...data1, slice1 ]\n//array2 = [...data2, slice2 ]\n//console.log(slice1); \n//array1.shift();\n//array2.shift();\nif(message[\"data\"][\"data\"][0][0]<10||message[\"data\"][\"data\"][0][0]>290){array1=zero_array;array2=zero_array;}updateData1(array1);updateData2(array2);}if(message[\"data\"][\"sensor\"]==\"line\"){array3=message[\"data\"][\"data\"][0];updateData3(array3);}}}};},[[data1],[data2],[data3]]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Grid,{container:true,spacing:4},/*#__PURE__*/React.createElement(Grid,{item:true,md:4,xs:4},/*#__PURE__*/React.createElement(Widget,{title:\"ИК\",noBodyPadding:true},/*#__PURE__*/React.createElement(ApexLineChart,{data:data1,type:\"line\",height:\"350\"}))),/*#__PURE__*/React.createElement(Grid,{item:true,md:4,xs:4},/*#__PURE__*/React.createElement(Widget,{title:\"УЗ\",noBodyPadding:true},/*#__PURE__*/React.createElement(ApexLineChart,{data:data2,type:\"line\",height:\"350\"}))),/*#__PURE__*/React.createElement(Grid,{item:true,md:4,xs:4},/*#__PURE__*/React.createElement(Widget,{title:\"\\u041B\\u0438\\u043D\\u0435\\u0439\\u043A\\u0430\",upperTitle:true,noBodyPadding:true},/*#__PURE__*/React.createElement(ApexHeatmap,{data:data3}))),/*#__PURE__*/React.createElement(Grid,{item:true,md:6,xs:12},/*#__PURE__*/React.createElement(Button,{variant:\"contained\",color:\"secondary\"},\"Set Stream\"))));}","map":{"version":3,"sources":["/home/dekor/eqvium/react_material_test/admin-full/src/pages/charts/LineCharts.js"],"names":["React","useState","useEffect","useRef","Grid","useTheme","Typography","Button","ReactApexChart","ApexCharts","ApexLineChart","ApexHeatmap","Widget","Charts","props","zero_array","Array","fill","ws","data1","updateData1","data2","updateData2","data3","updateData3","current","WebSocket","binaryType","onopen","console","log","onclose","close","onmessage","e","JSON","parse","data","message","hasOwnProperty","array1","array2","array3","len","length","i","shift"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport { Grid } from \"@material-ui/core\";\nimport { useTheme } from \"@material-ui/styles\";\nimport { Typography, Button } from '../../components/Wrappers'\nimport ReactApexChart from \"react-apexcharts\";\nimport ApexCharts from \"apexcharts\";\nimport ApexLineChart from \"./components/ApexLineChart\";\nimport ApexHeatmap from \"./components/ApexHeatmap\";\n\n// components\nimport Widget from \"../../components/Widget/Widget\";\n\n\n\nexport default function Charts(props) {\n\n  var zero_array = new Array(300).fill([0,0]);\n  //var 1_array = new Array(300).fill([300,0]);\n  //var prev = 0;\n\n  const ws = useRef(null);\n  const [data1, updateData1] = useState(zero_array);\n  const [data2, updateData2] = useState(zero_array);\n  const [data3, updateData3] = useState([0,0,0,0,0,0,0,0]);\n\n  useEffect(() => {\n        ws.current = new WebSocket(\"ws://79.143.25.41:8080/gear\");\n        ws.current.binaryType = 'arraybuffer';\n        ws.current.onopen = () => {\n          console.log(\"ws opened\");\n        }\n        ws.current.onclose = () => console.log(\"ws closed\");\n\n        return () => {\n            ws.current.close();\n        };\n    }, []);\n\n    useEffect(() => {\n        if (!ws.current) return;\n\n        ws.current.onmessage = e => {\n            console.log(JSON.parse(e.data));\n            const message = JSON.parse(e.data);\n            if( !message.hasOwnProperty('system')) {\n            let array1;\n            let array2;\n            let array3;\n            if (message[\"data\"][\"data\"] != null) {\n              if (message[\"data\"][\"sensor\"] == \"head\") {\n                var len = message[\"data\"][\"data\"].length;\n                //var slice1 = message[\"data\"][\"data\"].map(function(v){ return [v[0], v[1]] });\n                //var slice2 = message[\"data\"][\"data\"].map(function(v){ return [v[0], v[2]] });\n                //array1 = [...data1, [ message[\"data\"][\"data\"][0][0], message[\"data\"][\"data\"][0][1]]]; \n                //array2 = [...data2, [ message[\"data\"][\"data\"][0][0], message[\"data\"][\"data\"][0][2]]]; \n                for (var i = 0; i < len; i++) {\n                  array1 = [...data1, [ message[\"data\"][\"data\"][i][0], message[\"data\"][\"data\"][i][1]]];\n                  array2 = [...data2, [ message[\"data\"][\"data\"][i][0], message[\"data\"][\"data\"][i][2]]];\n                  array1.shift();\n                  array2.shift();\n                }\n                //array1 = [...data1, slice1 ]\n                //array2 = [...data2, slice2 ]\n                //console.log(slice1); \n                //array1.shift();\n                //array2.shift();\n                if (message[\"data\"][\"data\"][0][0] < 10 || message[\"data\"][\"data\"][0][0] > 290) {\n                  array1 = zero_array; \n                  array2 = zero_array;\n                } \n                updateData1(array1);\n                updateData2(array2);\n              }\n              if (message[\"data\"][\"sensor\"] == \"line\") {\n                array3 = message[\"data\"][\"data\"][0];\n                updateData3(array3);\n              }\n            }\n          }\n        };\n    }, [[data1], [data2], [data3]]);\n  \n  return (\n    <>\n      <Grid container spacing={4}>\n        <Grid item md={4} xs={4}>\n          <Widget title={\"ИК\"} noBodyPadding>\n            <ApexLineChart\n              data={data1}\n              type=\"line\"\n              height=\"350\"\n            />\n          </Widget>\n        </Grid>\n        <Grid item md={4} xs={4}>\n           <Widget title={\"УЗ\"} noBodyPadding>\n            <ApexLineChart\n              data={data2}\n              type=\"line\"\n              height=\"350\"\n            />\n          </Widget>\n\n        </Grid>\n        <Grid item md={4} xs={4}>\n         <Widget title=\"Линейка\" upperTitle noBodyPadding>\n            <ApexHeatmap data={data3}/ >\n          </Widget>\n        </Grid>\n        <Grid item md={6} xs={12}>\n           <Button  variant=\"contained\" color=\"secondary\" >Set Stream</Button>\n        </Grid>\n      </Grid>\n    </>\n  );\n}\n\n\n"]},"metadata":{},"sourceType":"module"}