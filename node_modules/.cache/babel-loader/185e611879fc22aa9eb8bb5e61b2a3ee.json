{"ast":null,"code":"import _slicedToArray from\"/home/dekor/eqvium/react_material_test/admin-full/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/home/dekor/eqvium/react_material_test/admin-full/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React from\"react\";import axios from\"axios\";import config from\"../config\";import{rows}from\"../pages/ecommerce/mock\";var ProductsContext=React.createContext();var rootReducer=function rootReducer(state,action){switch(action.type){case\"UPDATE_PRODUCTS\":return{isLoaded:true,products:action.payload,images:state.images?state.images:[]};case\"EDIT_PRODUCT\":var index=action.payload.id;return _objectSpread(_objectSpread({},state),{},{isLoaded:true,products:state.products.map(function(c){if(c.id===index){return _objectSpread(_objectSpread({},c),action.payload);}return c;})});case\"GET_IMAGES\":return _objectSpread(_objectSpread({},state),{},{images:action.payload});case\"CREATE_PRODUCT\":state.products.push(action.payload);return _objectSpread(_objectSpread({},state),{},{isLoaded:true,products:state.products});default:return _objectSpread({},state);}};var ProductsProvider=function ProductsProvider(_ref){var children=_ref.children;var _React$useReducer=React.useReducer(rootReducer,{isLoaded:false,products:rows}),_React$useReducer2=_slicedToArray(_React$useReducer,2),products=_React$useReducer2[0],setProducts=_React$useReducer2[1];return/*#__PURE__*/React.createElement(ProductsContext.Provider,{value:{products:products,setProducts:setProducts}},children);};var useProductsState=function useProductsState(){var context=React.useContext(ProductsContext);return context;};export function getProductsRequest(dispatch){// We check if app runs with backend mode\nif(config.isBackend){return axios.get(\"/products\").then(function(res){dispatch({type:\"UPDATE_PRODUCTS\",payload:res.data});});}}export function deleteProductRequest(_ref2){var id=_ref2.id,history=_ref2.history,dispatch=_ref2.dispatch;// We check if app runs with backend mode\nif(!config.isBackend)return;if(Array.isArray(id)){for(var key in id){axios.delete(\"/products/\"+id[key]).then(function(res){});}}else{axios.delete(\"/products/\"+id).then(function(res){getProductsRequest(dispatch);if(history.location.pathname!==\"/app/ecommerce/management\"){history.push(\"/app/ecommerce/management\");}return;});}getProductsRequest(dispatch);}export function getProductInfo(dispatch){// We check if app runs with backend mode\nif(config.isBackend){axios.get(\"/products\").then(function(res){dispatch({type:\"UPDATE_PRODUCTS\",payload:res.data});});}}export function updateProduct(product,dispatch){// We check if app runs with backend mode\nif(!config.isBackend)return;axios.put(\"/products/\"+product.id,product).then(function(res){dispatch({type:\"EDIT_PRODUCT\",payload:res.data});});}export function createProduct(product,dispatch){// We check if app runs with backend mode\nif(!config.isBackend)return;axios.post(\"/products\",product).then(function(res){dispatch({type:\"CREATE_PRODUCT\",payload:res.data});});}export function getProductsImages(dispatch){// We check if app runs with backend mode\nif(!config.isBackend)return;var replacer=function replacer(data){return data.map(function(c){return c.replace(/http:\\/\\/.+\\//,\"https://flatlogic-node-backend.herokuapp.com/assets/products/\");});};axios.get(\"/products/images-list\").then(function(res){dispatch({type:\"GET_IMAGES\",payload:replacer(res.data)});});}export{ProductsProvider,ProductsContext,useProductsState};","map":{"version":3,"sources":["/home/dekor/eqvium/react_material_test/admin-full/src/context/ProductContext.js"],"names":["React","axios","config","rows","ProductsContext","createContext","rootReducer","state","action","type","isLoaded","products","payload","images","index","id","map","c","push","ProductsProvider","children","useReducer","setProducts","useProductsState","context","useContext","getProductsRequest","dispatch","isBackend","get","then","res","data","deleteProductRequest","history","Array","isArray","key","delete","location","pathname","getProductInfo","updateProduct","product","put","createProduct","post","getProductsImages","replacer","replace"],"mappings":"+UAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CAEA,MAAOC,CAAAA,MAAP,KAAmB,WAAnB,CACA,OAASC,IAAT,KAAqB,yBAArB,CAEA,GAAMC,CAAAA,eAAe,CAAGJ,KAAK,CAACK,aAAN,EAAxB,CAEA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACC,KAAD,CAAQC,MAAR,CAAmB,CACrC,OAAQA,MAAM,CAACC,IAAf,EACE,IAAK,iBAAL,CACE,MAAO,CACLC,QAAQ,CAAE,IADL,CAELC,QAAQ,CAAEH,MAAM,CAACI,OAFZ,CAGLC,MAAM,CAAEN,KAAK,CAACM,MAAN,CAAeN,KAAK,CAACM,MAArB,CAA8B,EAHjC,CAAP,CAKF,IAAK,cAAL,CACE,GAAMC,CAAAA,KAAK,CAAGN,MAAM,CAACI,OAAP,CAAeG,EAA7B,CACA,sCACKR,KADL,MAEEG,QAAQ,CAAE,IAFZ,CAGEC,QAAQ,CAAEJ,KAAK,CAACI,QAAN,CAAeK,GAAf,CAAmB,SAAAC,CAAC,CAAI,CAChC,GAAIA,CAAC,CAACF,EAAF,GAASD,KAAb,CAAoB,CAClB,sCAAYG,CAAZ,EAAkBT,MAAM,CAACI,OAAzB,EACD,CACD,MAAOK,CAAAA,CAAP,CACD,CALS,CAHZ,GAWF,IAAK,YAAL,CACE,sCACKV,KADL,MAEEM,MAAM,CAAEL,MAAM,CAACI,OAFjB,GAKF,IAAK,gBAAL,CACEL,KAAK,CAACI,QAAN,CAAeO,IAAf,CAAoBV,MAAM,CAACI,OAA3B,EACA,sCACKL,KADL,MAEEG,QAAQ,CAAE,IAFZ,CAGEC,QAAQ,CAAEJ,KAAK,CAACI,QAHlB,GAMF,QACE,wBACKJ,KADL,EAnCJ,CAuCD,CAxCD,CA0CA,GAAMY,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,MAAkB,IAAfC,CAAAA,QAAe,MAAfA,QAAe,uBACTpB,KAAK,CAACqB,UAAN,CAAiBf,WAAjB,CAA8B,CAC5DI,QAAQ,CAAE,KADkD,CAE5DC,QAAQ,CAAER,IAFkD,CAA9B,CADS,wDAClCQ,QADkC,uBACxBW,WADwB,uBAKzC,mBACE,oBAAC,eAAD,CAAiB,QAAjB,EAA0B,KAAK,CAAE,CAAEX,QAAQ,CAARA,QAAF,CAAYW,WAAW,CAAXA,WAAZ,CAAjC,EACGF,QADH,CADF,CAKD,CAVD,CAYA,GAAMG,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,EAAM,CAC7B,GAAMC,CAAAA,OAAO,CAAGxB,KAAK,CAACyB,UAAN,CAAiBrB,eAAjB,CAAhB,CACA,MAAOoB,CAAAA,OAAP,CACD,CAHD,CAKA,MAAO,SAASE,CAAAA,kBAAT,CAA4BC,QAA5B,CAAsC,CAC3C;AACA,GAAIzB,MAAM,CAAC0B,SAAX,CAAsB,CACpB,MAAO3B,CAAAA,KAAK,CAAC4B,GAAN,CAAU,WAAV,EAAuBC,IAAvB,CAA4B,SAAAC,GAAG,CAAI,CACxCJ,QAAQ,CAAC,CAAElB,IAAI,CAAE,iBAAR,CAA2BG,OAAO,CAAEmB,GAAG,CAACC,IAAxC,CAAD,CAAR,CACD,CAFM,CAAP,CAGD,CACF,CAED,MAAO,SAASC,CAAAA,oBAAT,OAAyD,IAAzBlB,CAAAA,EAAyB,OAAzBA,EAAyB,CAArBmB,OAAqB,OAArBA,OAAqB,CAAZP,QAAY,OAAZA,QAAY,CAC9D;AACA,GAAI,CAACzB,MAAM,CAAC0B,SAAZ,CAAuB,OAEvB,GAAIO,KAAK,CAACC,OAAN,CAAcrB,EAAd,CAAJ,CAAuB,CACrB,IAAK,GAAIsB,CAAAA,GAAT,GAAgBtB,CAAAA,EAAhB,CAAoB,CAClBd,KAAK,CAACqC,MAAN,CAAa,aAAevB,EAAE,CAACsB,GAAD,CAA9B,EAAqCP,IAArC,CAA0C,SAAAC,GAAG,CAAI,CAAE,CAAnD,EACD,CACF,CAJD,IAIO,CACL9B,KAAK,CAACqC,MAAN,CAAa,aAAevB,EAA5B,EAAgCe,IAAhC,CAAqC,SAAAC,GAAG,CAAI,CAC1CL,kBAAkB,CAACC,QAAD,CAAlB,CACA,GAAIO,OAAO,CAACK,QAAR,CAAiBC,QAAjB,GAA8B,2BAAlC,CAA+D,CAC7DN,OAAO,CAAChB,IAAR,CAAa,2BAAb,EACD,CACD,OACD,CAND,EAOD,CACDQ,kBAAkB,CAACC,QAAD,CAAlB,CACD,CAED,MAAO,SAASc,CAAAA,cAAT,CAAwBd,QAAxB,CAAkC,CACvC;AACA,GAAIzB,MAAM,CAAC0B,SAAX,CAAsB,CACpB3B,KAAK,CAAC4B,GAAN,CAAU,WAAV,EAAuBC,IAAvB,CAA4B,SAAAC,GAAG,CAAI,CACjCJ,QAAQ,CAAC,CAAElB,IAAI,CAAE,iBAAR,CAA2BG,OAAO,CAAEmB,GAAG,CAACC,IAAxC,CAAD,CAAR,CACD,CAFD,EAGD,CACF,CAED,MAAO,SAASU,CAAAA,aAAT,CAAuBC,OAAvB,CAAgChB,QAAhC,CAA0C,CAC/C;AACA,GAAI,CAACzB,MAAM,CAAC0B,SAAZ,CAAuB,OAEvB3B,KAAK,CAAC2C,GAAN,CAAU,aAAeD,OAAO,CAAC5B,EAAjC,CAAqC4B,OAArC,EAA8Cb,IAA9C,CAAmD,SAAAC,GAAG,CAAI,CACxDJ,QAAQ,CAAC,CAAElB,IAAI,CAAE,cAAR,CAAwBG,OAAO,CAAEmB,GAAG,CAACC,IAArC,CAAD,CAAR,CACD,CAFD,EAGD,CAED,MAAO,SAASa,CAAAA,aAAT,CAAuBF,OAAvB,CAAgChB,QAAhC,CAA0C,CAC/C;AACA,GAAI,CAACzB,MAAM,CAAC0B,SAAZ,CAAuB,OAEvB3B,KAAK,CAAC6C,IAAN,CAAW,WAAX,CAAwBH,OAAxB,EAAiCb,IAAjC,CAAsC,SAAAC,GAAG,CAAI,CAC3CJ,QAAQ,CAAC,CAAElB,IAAI,CAAE,gBAAR,CAA0BG,OAAO,CAAEmB,GAAG,CAACC,IAAvC,CAAD,CAAR,CACD,CAFD,EAGD,CAED,MAAO,SAASe,CAAAA,iBAAT,CAA2BpB,QAA3B,CAAqC,CAC1C;AACA,GAAI,CAACzB,MAAM,CAAC0B,SAAZ,CAAuB,OAEvB,GAAMoB,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAAAhB,IAAI,CAAI,CACvB,MAAOA,CAAAA,IAAI,CAAChB,GAAL,CAAS,SAAAC,CAAC,CAAI,CACnB,MAAOA,CAAAA,CAAC,CAACgC,OAAF,CACL,eADK,CAEL,+DAFK,CAAP,CAID,CALM,CAAP,CAMD,CAPD,CASAhD,KAAK,CAAC4B,GAAN,CAAU,uBAAV,EAAmCC,IAAnC,CAAwC,SAAAC,GAAG,CAAI,CAC7CJ,QAAQ,CAAC,CAAElB,IAAI,CAAE,YAAR,CAAsBG,OAAO,CAAEoC,QAAQ,CAACjB,GAAG,CAACC,IAAL,CAAvC,CAAD,CAAR,CACD,CAFD,EAGD,CAED,OAASb,gBAAT,CAA2Bf,eAA3B,CAA4CmB,gBAA5C","sourcesContent":["import React from \"react\";\nimport axios from \"axios\";\n\nimport config from \"../config\";\nimport { rows } from \"../pages/ecommerce/mock\";\n\nconst ProductsContext = React.createContext();\n\nconst rootReducer = (state, action) => {\n  switch (action.type) {\n    case \"UPDATE_PRODUCTS\":\n      return {\n        isLoaded: true,\n        products: action.payload,\n        images: state.images ? state.images : []\n      };\n    case \"EDIT_PRODUCT\":\n      const index = action.payload.id;\n      return {\n        ...state,\n        isLoaded: true,\n        products: state.products.map(c => {\n          if (c.id === index) {\n            return { ...c, ...action.payload };\n          }\n          return c;\n        })\n      };\n\n    case \"GET_IMAGES\":\n      return {\n        ...state,\n        images: action.payload\n      };\n\n    case \"CREATE_PRODUCT\":\n      state.products.push(action.payload);\n      return {\n        ...state,\n        isLoaded: true,\n        products: state.products\n      };\n\n    default:\n      return {\n        ...state\n      };\n  }\n};\n\nconst ProductsProvider = ({ children }) => {\n  const [products, setProducts] = React.useReducer(rootReducer, {\n    isLoaded: false,\n    products: rows\n  });\n  return (\n    <ProductsContext.Provider value={{ products, setProducts }}>\n      {children}\n    </ProductsContext.Provider>\n  );\n};\n\nconst useProductsState = () => {\n  const context = React.useContext(ProductsContext);\n  return context;\n};\n\nexport function getProductsRequest(dispatch) {\n  // We check if app runs with backend mode\n  if (config.isBackend) {\n    return axios.get(\"/products\").then(res => {\n      dispatch({ type: \"UPDATE_PRODUCTS\", payload: res.data });\n    });\n  }\n}\n\nexport function deleteProductRequest({ id, history, dispatch }) {\n  // We check if app runs with backend mode\n  if (!config.isBackend) return;\n\n  if (Array.isArray(id)) {\n    for (let key in id) {\n      axios.delete(\"/products/\" + id[key]).then(res => {});\n    }\n  } else {\n    axios.delete(\"/products/\" + id).then(res => {\n      getProductsRequest(dispatch);\n      if (history.location.pathname !== \"/app/ecommerce/management\") {\n        history.push(\"/app/ecommerce/management\");\n      }\n      return;\n    });\n  }\n  getProductsRequest(dispatch);\n}\n\nexport function getProductInfo(dispatch) {\n  // We check if app runs with backend mode\n  if (config.isBackend) {\n    axios.get(\"/products\").then(res => {\n      dispatch({ type: \"UPDATE_PRODUCTS\", payload: res.data });\n    });\n  }\n}\n\nexport function updateProduct(product, dispatch) {\n  // We check if app runs with backend mode\n  if (!config.isBackend) return;\n\n  axios.put(\"/products/\" + product.id, product).then(res => {\n    dispatch({ type: \"EDIT_PRODUCT\", payload: res.data });\n  });\n}\n\nexport function createProduct(product, dispatch) {\n  // We check if app runs with backend mode\n  if (!config.isBackend) return;\n\n  axios.post(\"/products\", product).then(res => {\n    dispatch({ type: \"CREATE_PRODUCT\", payload: res.data });\n  });\n}\n\nexport function getProductsImages(dispatch) {\n  // We check if app runs with backend mode\n  if (!config.isBackend) return;\n\n  const replacer = data => {\n    return data.map(c => {\n      return c.replace(\n        /http:\\/\\/.+\\//,\n        \"https://flatlogic-node-backend.herokuapp.com/assets/products/\"\n      );\n    });\n  };\n\n  axios.get(\"/products/images-list\").then(res => {\n    dispatch({ type: \"GET_IMAGES\", payload: replacer(res.data) });\n  });\n}\n\nexport { ProductsProvider, ProductsContext, useProductsState };\n"]},"metadata":{},"sourceType":"module"}