{"ast":null,"code":"var _jsxFileName = \"/home/dekor/eqvium/react_material_test/admin-full/src/pages/charts/LineCharts.js\";\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { Grid } from \"@material-ui/core\";\nimport { useTheme } from \"@material-ui/styles\";\nimport { Typography, Button } from '../../components/Wrappers';\nimport ReactApexChart from \"react-apexcharts\";\nimport ApexCharts from \"apexcharts\";\nimport ApexLineChart from \"./components/ApexLineChart\";\nimport ApexHeatmap from \"./components/ApexHeatmap\"; // components\n\nimport Widget from \"../../components/Widget/Widget\";\nexport default function Charts(props) {\n  var zero_array = new Array(300).fill([0, 0]);\n  const ws = useRef(null);\n  const [data1, updateData1] = useState(zero_array);\n  const [data2, updateData2] = useState(zero_array);\n  const [data3, updateData3] = useState([0, 0, 0, 0, 0, 0, 0, 0]);\n  useEffect(() => {\n    ws.current = new WebSocket(\"ws://79.143.25.41:8080/gear\");\n    ws.current.binaryType = 'arraybuffer';\n\n    ws.current.onopen = () => console.log(\"ws opened\");\n\n    ws.current.onclose = () => console.log(\"ws closed\");\n\n    return () => {\n      ws.current.close();\n    };\n  }, []);\n  useEffect(() => {\n    if (!ws.current) return;\n\n    ws.current.onmessage = e => {\n      console.log(JSON.parse(e.data));\n      const message = JSON.parse(e.data);\n\n      if (!message.hasOwnProperty('system')) {\n        let array1;\n        let array2;\n        let array3;\n\n        if (message[\"data\"][\"data\"] != null) {\n          if (message[\"data\"][\"sensor\"] == \"head\") {\n            array1 = [...data1, [message[\"data\"][\"data\"][0][0], message[\"data\"][\"data\"][0][1]]];\n            array2 = [...data2, [message[\"data\"][\"data\"][0][0], message[\"data\"][\"data\"][0][2]]];\n            array1.shift();\n            array2.shift();\n\n            if (message[\"data\"][\"data\"][0][0] == 0 || message[\"data\"][\"data\"][0][0] == 300) {\n              array1 = zero_array;\n              array2 = zero_array;\n            }\n\n            updateData1(array1);\n            updateData2(array2);\n          }\n\n          if (message[\"data\"][\"sensor\"] == \"line\") {\n            array3 = message[\"data\"][\"data\"][0];\n            updateData3(array3);\n          }\n        }\n      }\n    };\n  }, [[data1], [data2], [data3]]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    spacing: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    md: 4,\n    xs: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Widget, {\n    title: \"ИК\",\n    noBodyPadding: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ApexLineChart, {\n    data: data1,\n    type: \"line\",\n    height: \"350\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    md: 4,\n    xs: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Widget, {\n    title: \"УЗ\",\n    noBodyPadding: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 12\n    }\n  }, /*#__PURE__*/React.createElement(ApexLineChart, {\n    data: data2,\n    type: \"line\",\n    height: \"350\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    md: 4,\n    xs: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Widget, {\n    title: \"\\u041B\\u0438\\u043D\\u0435\\u0439\\u043A\\u0430\",\n    upperTitle: true,\n    noBodyPadding: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 10\n    }\n  }, /*#__PURE__*/React.createElement(ApexHeatmap, {\n    data: data3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    md: 6,\n    xs: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"contained\",\n    color: \"secondary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 12\n    }\n  }, \"Set Stream\"))));\n}","map":{"version":3,"sources":["/home/dekor/eqvium/react_material_test/admin-full/src/pages/charts/LineCharts.js"],"names":["React","useState","useEffect","useRef","Grid","useTheme","Typography","Button","ReactApexChart","ApexCharts","ApexLineChart","ApexHeatmap","Widget","Charts","props","zero_array","Array","fill","ws","data1","updateData1","data2","updateData2","data3","updateData3","current","WebSocket","binaryType","onopen","console","log","onclose","close","onmessage","e","JSON","parse","data","message","hasOwnProperty","array1","array2","array3","shift"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport { Grid } from \"@material-ui/core\";\nimport { useTheme } from \"@material-ui/styles\";\nimport { Typography, Button } from '../../components/Wrappers'\nimport ReactApexChart from \"react-apexcharts\";\nimport ApexCharts from \"apexcharts\";\nimport ApexLineChart from \"./components/ApexLineChart\";\nimport ApexHeatmap from \"./components/ApexHeatmap\";\n\n// components\nimport Widget from \"../../components/Widget/Widget\";\n\n\n\nexport default function Charts(props) {\n\n  var zero_array = new Array(300).fill([0,0]);\n\n  const ws = useRef(null);\n  const [data1, updateData1] = useState(zero_array);\n  const [data2, updateData2] = useState(zero_array);\n  const [data3, updateData3] = useState([0,0,0,0,0,0,0,0]);\n\n  useEffect(() => {\n        ws.current = new WebSocket(\"ws://79.143.25.41:8080/gear\");\n        ws.current.binaryType = 'arraybuffer';\n        ws.current.onopen = () => console.log(\"ws opened\");\n        ws.current.onclose = () => console.log(\"ws closed\");\n\n        return () => {\n            ws.current.close();\n        };\n    }, []);\n\n    useEffect(() => {\n        if (!ws.current) return;\n\n        ws.current.onmessage = e => {\n            console.log(JSON.parse(e.data));\n            const message = JSON.parse(e.data);\n            if( !message.hasOwnProperty('system')) {\n            let array1;\n            let array2;\n            let array3;\n            if (message[\"data\"][\"data\"] != null) {\n            if (message[\"data\"][\"sensor\"] == \"head\") {\n              array1 = [...data1, [ message[\"data\"][\"data\"][0][0], message[\"data\"][\"data\"][0][1]]]; \n              array2 = [...data2, [ message[\"data\"][\"data\"][0][0], message[\"data\"][\"data\"][0][2]]]; \n              array1.shift();\n              array2.shift();\n              if (message[\"data\"][\"data\"][0][0] == 0 || message[\"data\"][\"data\"][0][0] == 300) {\n              array1 = zero_array; \n              array2 = zero_array;\n              } \n              updateData1(array1);\n              updateData2(array2);\n            }\n            if (message[\"data\"][\"sensor\"] == \"line\") {\n              array3 = message[\"data\"][\"data\"][0];\n              updateData3(array3);\n            }\n            }\n            }\n        };\n    }, [[data1], [data2], [data3]]);\n  \n  return (\n    <>\n      <Grid container spacing={4}>\n        <Grid item md={4} xs={4}>\n          <Widget title={\"ИК\"} noBodyPadding>\n            <ApexLineChart\n              data={data1}\n              type=\"line\"\n              height=\"350\"\n            />\n          </Widget>\n        </Grid>\n        <Grid item md={4} xs={4}>\n           <Widget title={\"УЗ\"} noBodyPadding>\n            <ApexLineChart\n              data={data2}\n              type=\"line\"\n              height=\"350\"\n            />\n          </Widget>\n\n        </Grid>\n        <Grid item md={4} xs={4}>\n         <Widget title=\"Линейка\" upperTitle noBodyPadding>\n            <ApexHeatmap data={data3}/ >\n          </Widget>\n        </Grid>\n        <Grid item md={6} xs={12}>\n           <Button  variant=\"contained\" color=\"secondary\" >Set Stream</Button>\n        </Grid>\n      </Grid>\n    </>\n  );\n}\n\n\n"]},"metadata":{},"sourceType":"module"}